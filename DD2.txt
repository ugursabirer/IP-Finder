using Microsoft.Office.Interop.Outlook;
using Microsoft.Office.Tools.Ribbon;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace OutlookAddInDD2
{
    public partial class Ribbon1
    {
        List<RibbonDropDownItem> items = new List<RibbonDropDownItem>();
        List<string> mails = new List<string>();

        private void Ribbon1_Load(object sender, RibbonUIEventArgs e)
        {
            AddButtonsToDropDown();
        }

        private void AddButtonsToDropDown()
        {
            RibbonDropDownItem subject = this.Factory.CreateRibbonDropDownItem();
            subject.Label = "-Talep Konusu-";
            dropDown1.Items.Add(subject);

            RibbonDropDownItem item1 = this.Factory.CreateRibbonDropDownItem();
            item1.Label = "Genel";
            mails.Add("A@turkcell.com.tr");
            RibbonDropDownItem item2 = this.Factory.CreateRibbonDropDownItem();
            item2.Label = "Ana Fonksiyonlar Hukuk İşleri";
            mails.Add("B@turkcell.com.tr");
            RibbonDropDownItem item3 = this.Factory.CreateRibbonDropDownItem();
            item3.Label = "Stratejik Fonksiyonlar Hukuk İşleri";
            mails.Add("C@turkcell.com.tr");
            RibbonDropDownItem item4 = this.Factory.CreateRibbonDropDownItem();
            item4.Label = "Regülasyon";
            mails.Add("D@turkcell.com.tr");
            RibbonDropDownItem item5 = this.Factory.CreateRibbonDropDownItem();
            item5.Label = "Reklam ve Dış İletişim";
            mails.Add("E@turkcell.com.tr");

            items.Add(item1);
            items.Add(item2);
            items.Add(item3);
            items.Add(item4);
            items.Add(item5);
            foreach (var item in items)
            {
                dropDown1.Items.Add(item);
            }
        }

        private void dropDown1_SelectionChanged(object sender, RibbonControlEventArgs e)
        {
            Microsoft.Office.Interop.Outlook.Application application = new Microsoft.Office.Interop.Outlook.Application();
            MailItem mail = application.CreateItem(OlItemType.olMailItem);

            RibbonDropDownItem dropDownItem = dropDown1.SelectedItem;
            string itemLabel = dropDownItem.Label;

            for (int i = 0; i < items.Count; i++)
            {
                if (itemLabel == items[i].Label)
                {
                    mail.To = mails[i];
                    mail.Importance = Microsoft.Office.Interop.Outlook.OlImportance.olImportanceNormal;
                    mail.Display();
                }
            }
        }
    }
}
